<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>API to expose the Outline algorithm</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>
  
  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="66" alt="WICG" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">A partial archive of discourse.wicg.io as of Saturday February 24, 2024.</div>
    <h1 class="topic-title">API to expose the Outline algorithm</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1671_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">robin</div>
          <div class="creation_date">2014-05-21</div>
          <div class="post_content">
<p>HTML supports an <a href="http://www.w3.org/html/wg/drafts/html/master/sections.html#outlines">outline algorithm</a> which is currently supported in a number of tools but not exposed in the browser. Computing outlines can be supported in script, but is easy to get wrong. Would there be interest in adding a method that would expose this information?</p>
<p>The outline is too slow to compute to make this an attribute, but it could be returned by a method on demand.</p>
<p>If this is useful to you, I’d be interested in hearing how you plan to use it so that we can give it the right shape.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1825_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">SteveF</div>
          <div class="creation_date">2014-05-21</div>
          <div class="post_content">
<p>yes and yes. i have envisaged in my limited understanding sort of way a read only ‘level’ attribute for h1-h6 being exposed in the DOM which can be queried by 3rd part tools/scripting. The attribute would reflect the outline depth of the heading.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1818_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">briankardell</div>
          <div class="creation_date">2014-05-21</div>
          <div class="post_content">
<p>To make sure I understand - you are suggesting a read-only method that would return… some new OM?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/9_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">brucel</div>
          <div class="creation_date">2014-05-21</div>
          <div class="post_content">
<p>Related: I’d like some CSS thing like :heading-level(3) that would let me style “logical” h3s. section section h1, section article h1, article section h1, article article h1, nav article h1, article nav h1, article section h1 … etc is a major PITA that bloats stylesheets.</p>
<p>Someone will now tell me such a thing already exists, and I’m  a massive fool.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1818_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">briankardell</div>
          <div class="creation_date">2014-05-21</div>
          <div class="post_content">
<p>Related? <a href="https://github.com/ThePacielloGroup/w3c-heading/blob/gh-pages/README.md#under-the-hood">https://github.com/ThePacielloGroup/w3c-heading/blob/gh-pages/README.md#under-the-hood</a></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1820_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">domenic</div>
          <div class="creation_date">2014-05-21</div>
          <div class="post_content">
<p>Here are some use cases I can think of:</p>
<ul>
<li>Specs. Pretty obvious; spec preprocessors do this already.</li>
<li>Wikis, e.g. Wikipedia’s TOC.</li>
<li>eBooks, in some form. I’ve experimented with eBooks that are a single HTML file, instead of the industry-standard zipped-up-multiple-XHTML files format. In this case generating the TOC via such an algorithm would be excellent.</li>
</ul>
<p>In all cases I would probably create a custom element to wrap the imperative API into whatever format is most appropriate for my use case, e.g. trimming off title pages for a book TOC or removing the h1 level for a Wikipedia TOC.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1825_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">SteveF</div>
          <div class="creation_date">2014-05-21</div>
          <div class="post_content">
<p>yes, that is an ongoing exploration of providing a heading feature encompasses the outline concept and how it could/should work</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1818_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">briankardell</div>
          <div class="creation_date">2014-05-21</div>
          <div class="post_content">
<p>you’re saying this has been discussed? what the OM looks like and so on?  If so, link?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1671_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">robin</div>
          <div class="creation_date">2014-05-21</div>
          <div class="post_content">
<p>It’s sort of a view on the DOM, an object structure which references elements, possibly Ranges covering sections (super useful when there’s no <code>&lt;section&gt;</code>). Nothing radically new <img alt=":smile:" class="emoji" src="//discourse.wicg.io/images/emoji/twitter/smile.png?v=5" title=":smile:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1671_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">robin</div>
          <div class="creation_date">2014-05-21</div>
          <div class="post_content">
<p>I also like the ebook use case a lot, though paradoxically I am still unsure as to <code>&lt;toc&gt;</code> (paradoxically because script-less would be great for ebooks).</p>
<p>There’s a <a href="http://lists.w3.org/Archives/Public/public-html/2014Feb/thread.html#msg125">thread on the topic on public-html</a> (who said nothing of interest happened there? :).</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1825_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">SteveF</div>
          <div class="creation_date">2014-05-21</div>
          <div class="post_content">
<p>This is related to what have been talking about in a <a href="https://github.com/ThePacielloGroup/w3c-heading/issues/12" rel="nofollow noopener">w3c-heading issue</a>. we decided to add a ‘level’ attribute. Not just the CSS case but it helped in deciding.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1825_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">SteveF</div>
          <div class="creation_date">2014-05-21</div>
          <div class="post_content">
<p>From an accessibility layer perspective, there is already a <a href="http://www.w3.org/html/wg/drafts/html/master/dom.html#sec-implicit-aria-semantics">requirement in the spec</a> to implement the outline algorithm as it is needed to calculate a headings outline depth:</p>
<p>required mapping:</p>
<blockquote>
<p>hx = heading role, with the  aria-level property set to the element’s
outline depth.</p>
</blockquote>
<p>So if the outline algorithm is required to be implemented anyway, why hide it in the acc layer?</p>
<p>Also note that in practical terms outline depth information needs to be available in the DOM for most AT.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1828_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">heydonworks</div>
          <div class="creation_date">2014-05-22</div>
          <div class="post_content">
<p>I’m imagining something along the lines of the browser “fixing” heading levels in the way they already try to close unclosed elements or add fallback / default attributes.</p>
<p>That way, authors using sections with headings would have the choice of using a generic  <code>&lt;h&gt;</code> and styling using something similar to what <span class="mention">@brucel</span> suggested (perhaps <code>h:level(2)</code> for second level) <em>or</em> use <code>&lt;h1&gt;</code> to <code>&lt;h6&gt;</code> to determine style (font size, I suppose) and the browser would correct for structure.</p>
<p>The corrected structural info would be forwarded to AT in much the same way as adding <code>aria-level="3"</code> to an <code>&lt;h1&gt;</code> nested three sections deep.</p>
<pre><code class="lang-auto">&lt;body&gt;
   &lt;h1&gt;Master Heading&lt;/h1&gt;
   &lt;section&gt;
      &lt;h2&gt;Sub Heading&lt;/h2&gt;
      &lt;section&gt;
         &lt;h1 aria-level="3"&gt;Visually Big Heading&lt;/h1&gt; &lt;!-- corrected in DOM --&gt;
      &lt;/section&gt;
   &lt;section&gt;
&lt;/body&gt;
</code></pre>
<p>Am I on the right track?</p>
<p>I’m guessing some correction would be possible without the depth dimension of sectioning elements too. For example:</p>
<pre><code class="lang-auto">&lt;h1&gt;Master Heading&lt;/h1&gt;
&lt;h3 aria-level="2"&gt;Sub heading&lt;/h3&gt; &lt;!-- corrected in DOM --&gt;
</code></pre>
<p>That is, the next element after <code>&lt;h1&gt;</code> belonging to the array <code>[h1,h2,h3,h4,h5]</code> should be an <code>&lt;h2&gt;</code>.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1818_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">briankardell</div>
          <div class="creation_date">2014-07-17</div>
          <div class="post_content">
<p>Anyone done any work on this?  I’m still very interested in what it returns exactly… Is it a new OM?  It feels like it is semi-related conceptually (as a general problem that is) to the render-tree in the sense that it is ‘another view on the DOM’ which isn’t historically exposed… I’d like to see more details on what someone is thinking that would look like and how to make it practical/perf - and if it is ‘on demand’ could we prollyfill it along with spec’ing it out.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1826_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">sideshowbarker</div>
          <div class="creation_date">2014-07-17</div>
          <div class="post_content">
<aside class="quote" data-full="true" data-post="14" data-topic="55">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="//discourse.wicg.io/user_avatar/discourse.wicg.io/briankardell/40/70_1.png" width="20"/> briankardell:</div>
<blockquote>
<p>Anyone done any work on this?  I’m still very interested in what it returns exactly…</p>
</blockquote>
</aside>
<p>I’m not really sold on Robin’s “view” idea. I’m not sure we need this to be any more complex then just, we expose a way to create a static outline on demand, which consists of an “Outline” object that’s just a tree of “Section” nodes—where the spec would need to define what a Section node is (simple to define), and from that define what an Outline is (even simpler to define).</p>
<p>For an existing JS implementation that pretty much does exactly that, see Dominykas Blyžė’s h5o HTML5 outliner code, in particular, his code for the <code>HTML5Outline(*element*)</code> method here:</p>
<p><a href="https://github.com/h5o/h5o-js/blob/master/src/HTML5Outline.js" rel="nofollow noopener">https://github.com/h5o/h5o-js/blob/master/src/HTML5Outline.js</a></p>
<p>But if we were to standardize it, I think that instead of that approach, it should just be a new method for HTMLElement, so that you could just create an Outline object with <code>element.createOutline()</code> (so, with no args needed).</p>
<p>However I wouldn’t object to instead just exposing it as a standard <code>document.createOutline(*element*)</code> method (i.e., basically just what Dominykas’s <code>HTML5Outline(*element*)</code> method does.</p>
<p>Implicit in all that of course is that we’d want to provide developers with the flexibility to create an outline not just for the entire document, but from any arbitrary subtree of the document, with whatever element they want at the root of the outline.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1818_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">briankardell</div>
          <div class="creation_date">2014-07-17</div>
          <div class="post_content">
<p>So, based on that, I believe you’re suggesting it would return an OM like so… ?</p>
<p><img height="418" src="//discourse.wicg.io/uploads/default/390/e66e21a11014a05d.png" width="649"/> </p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/89_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">madcampos</div>
          <div class="creation_date">2014-09-05</div>
          <div class="post_content">
<p>I like the idea and as my suggestion it would be a method like: <code>element.outline()</code> and would return a token list containing the html elements or another token list for the next depth. Just this simple as it’s lightweight and authors could write on top of it.</p>
<p>From the css perspective it could be a <code>@oultine-level(n)</code> directive that we could style just like a media query, and as such cascade to grather depths.</p>
<p>A use case for this could be a wiki with a toc (generated), some content aside and a few levels of depth in the document. in this example the toc could have one style, an aside with metadata another, aside images and quotes yet another style and references a different one. The wiki “chrome” could still be also rendered in another way separated from it’s content.</p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>
