<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>Browser engine versioning standard, allowing breaking changes, moving the web more forward without the cruft</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>
  
  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="66" alt="WICG" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">A partial archive of discourse.wicg.io as of Saturday February 24, 2024.</div>
    <h1 class="topic-title">Browser engine versioning standard, allowing breaking changes, moving the web more forward without the cruft</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2910_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">trusktr</div>
          <div class="creation_date">2020-08-10</div>
          <div class="post_content">
<p>I think it’d be neat if there was a standard that allowed browser engines to move forward with breaking changes (or any changes) under the concept of “versions”.</p>
<p>Websites could specify which version of features they use. Engines could by default ship with the latest version. If a website is using an older version of features, then the browser prompts the user to install those older features.</p>
<p>This could allow, for example, things like the problematic new EcmaScript class fields to be fixed in a way that newer websites could specify that they use that version of the engine, while older browser continue to use a previous version.</p>
<p>The only thing back-ported to older versions are security fixes (and bug fixes if vendors care enough).</p>
<p>How would that look like? Maybe a root-level entry in <code>manifest.json</code> or something could specify a <code>webVersion</code> field, or something.</p>
<p>As specs move forward, a snapshot of all the specs is created at some version number. This includes the spec’d state for HTML, CSS, DOM, EcmaScript, etc.</p>
<p>This would help to reduce the size of browser engines while bringing the web forward. Eventually, hen old websites are no longer visited and old features are no longer used, the average user will not download that version of the engine. They’ll only by default have the latest version with latest features, and sometimes they’ll need to accept a version download for websites still using older versions.</p>
<p>Perhaps a browser would ship with the most common versions still in use. There’d be some statistical threshold for determining which versions to ship with by default. Etc.</p>
<p>New versions doesn’t mean removing old features (though it might). A new versions might remove bad features of the web, or only make some fixes to bad parts.</p>
<p>A main downside of this would be that more code has to be maintained by vendors.</p>
<hr/>
<p>Anyway, I am dreaming of a better landscape.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3804_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">simevidas</div>
          <div class="creation_date">2020-08-23</div>
          <div class="post_content">
<p>I’m not sure that a prompt to install an older version of the engine when visiting older sites is a good user experience for the web. Would people even understand what is being asked?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2910_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">trusktr</div>
          <div class="creation_date">2020-08-28</div>
          <div class="post_content">
<p>If the prompt said something like</p>
<blockquote>
<p>This website requires older browser features to be installed. Proceed?</p>
</blockquote>
<p>it would be understandable.</p>
<p>Maybe it would have more information, like</p>
<blockquote>
<p>This website requires browser features v3 to be installed.
Proceed?</p>
</blockquote>
<p>How <em>can</em> we bring the web forward without all the cruft? It isn’t scalable to simply keep adding more and more web features. Just imagine if we continue at this pace how the web will be in 20 years.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2910_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">trusktr</div>
          <div class="creation_date">2020-08-28</div>
          <div class="post_content">
<p>We deprecated Flash. Surely we can do this with builtin features too.</p>
<p>Removing features is one thing. I am also suggesting maybe there is a way to manage the (older) features, to allow them to be optionally installable. Perhaps it would be based on snapshots of the browser engine. Rather than modifying browser implementations so that the code has a bunch of conditional checks, it would instead download snapshots of the engine code, where a previous version may contain entirely different code that may have existed prior to a total refactor (for example).</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3804_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">simevidas</div>
          <div class="creation_date">2020-08-28</div>
          <div class="post_content">
<p>I have a feeling that browser vendors would not want to do this. I remember a blink-dev discussion where a legacy feature was used by 0.08% (IIRC) of web pages, and they were hesitating to remove it. Compatibility with the legacy web is like a law of physics to them, unbreakable.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1765_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">isiahmeadows</div>
          <div class="creation_date">2020-09-05</div>
          <div class="post_content">
<p>Are you aware of how <em>long</em> it’s taking to remove Flash? Or how long it took to remove Java for that matter? It took about five years (2013-2018) to remove Java applets, and Flash is still on the tail end of <a href="https://blog.adobe.com/en/publish/2017/07/25/adobe-flash-update.html#gs.fda8qz" rel="nofollow noopener">its three-year deprecation timeline scheduled to finalize December 31 of this year</a>. (For context, removal of both of these were a massive, genuine necessity to protect end users, not just little nice-to-haves for browsers.) Even on the JS side, it was a struggle to ensure that <code>let[x] = 1</code> could be repurposed from indexed assignment to a variable declaration, and removing <code>arguments.caller</code> itself was a monstrous task that started back in ES5 and took until ES2017 for them to finally be able to pull the plug.</p>
<p>Removing features is nearly impossible on the web, and even the biggest hacks generally have to be maintained. And not only that, browsers will still have to implement them for possibly years to come. Tf you want to see how well it works out in practice, just look at how well Firefox’s old JS versioning attempt worked out (spoiler alert: it didn’t and they dropped support for it only a few versions in, before it even really took off).</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1765_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">isiahmeadows</div>
          <div class="creation_date">2020-09-05</div>
          <div class="post_content">
<p>Keep in mind 0.08% of websites is still <a href="https://www.internetlivestats.com/total-number-of-websites/" rel="nofollow noopener">almost 1.5 million websites</a>. And that’s just web<em>sites</em>, not web <em>pages</em>. 0.08% of the web is a <em>lot</em> of web, and do you really want to unilaterally break millions of pages and likely annoy or anger millions of users?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2910_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">trusktr</div>
          <div class="creation_date">2020-09-11</div>
          <div class="post_content">
<p>You know how in JavaScript new features enable the removal of others by means of introducing a new mode (f.e. “use strict”, or modules)?</p>
<p>Maybe we need two things:</p>
<ul>
<li>A standard way for browsers to introduce new modes (not just for JavaScript, but for HTML/CSS) that can introduce new features while dropping others.</li>
<li>An official way to deprecate the old features (old modes) after some time (even if that happens to be spec’d to 3 or 5 years).</li>
</ul>
<p>Could that be possible?</p>
<blockquote>
<p>do you really want to unilaterally break millions of pages and likely annoy or anger millions of users?</p>
</blockquote>
<p>Well I’d like to avoid it, but maybe that’s part of the problem.</p>
<p>Libraries need to accept that some people dislike changes, but changes are required to bring libraries to a new and better future. Maybe the web needs that, and can accept that some few portion of people will not like it.</p>
<p>Maybe the annoyance to that fraction of users will ultimately make them happier and everyone else happier in the longer term?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3315_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">easrng</div>
          <div class="creation_date">2021-01-27</div>
          <div class="post_content">
<p>We used to have that in doctypes. Now with <code>&lt;!DOCTYPE html&gt;</code> there is no version information anymore. Maybe we should bring back doctype versions, ex <code>&lt;!DOCTYPE html 80&gt;</code> or something.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1137_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Garbee</div>
          <div class="creation_date">2021-01-27</div>
          <div class="post_content">
<p>Even with doctype versioning or the earlier proposed alert of “You need to install X features is it ok to proceed?” these both have the same fundamental failures.</p>
<ol>
<li>You still don’t remove the feature. It’s still present just in a different “mode”.</li>
<li>In the latter case, you are putting the onus on the user to understand what is going on. That is simply infeasible given how vague these would need to be in order to be remotely achievable.</li>
<li>Even <em>IF</em> by some extreme measure this was rolled out, it just makes the web more complicated. This creates more pathways in the engines to do their jobs. The more pathways you have, the more difficult it is to add new things. So you’ll end up stagnating the platform rather than speed up development.</li>
</ol>
<p>It’s just not a good idea. We need less pathways not more. Less pathways allows for users and developers to have clear expectations when taking advantage of the platform.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2910_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">trusktr</div>
          <div class="creation_date">2021-03-10</div>
          <div class="post_content">
<p><span class="mention">@easrng</span> <code>DOCTYPE</code> is not enough, that covers only ML syntax. The versioning idea would cover all browser APIs.</p>
<aside class="quote no-group" data-post="10" data-topic="4720" data-username="Garbee">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="//discourse.wicg.io/user_avatar/discourse.wicg.io/garbee/40/1137_2.png" width="20"/> Garbee:</div>
<blockquote>
<ol>
<li>The more pathways you have, the more difficult it is to add new things. So you’ll end up stagnating the platform rather than speed up development.</li>
</ol>
</blockquote>
</aside>
<p>Well the whole point is old pathways could be left behind, with their issues. Initially, there may be a bunch of organization needed to update a browser code base to make it suitable for versioning the parts. But eventually, new versions may be cleanly updated with minimal changes needed to old versions, or critical patches applied to re-usable code that will be used in multiple versions.</p>
<p>The key is that most code follows existing specs, which don’t change too much unless there’s a serious issue with them. So APIs could be made to be re-usable so old versions can use stuff that new versions have carried over into their set of APIs.</p>
<p>For example, some older version may have both <code>HTMLHttpRequest</code> and <code>fetch</code>, and a new version would have only <code>fetch</code>, but the old version’s <code>fetch</code> is the same one from the new version, re-using the same code.</p>
<p>Engineers will figure how to put re-usable code into a common place, to share across versions.</p>
<p>I imagine version changes need to represent major changes. For example, going from Custom Elements v0 to v1 was fairly major. It would be easy to leave one for an older version and the new one in a new version, but it is not like we would want to have 10 versions of custom elements just because we have a versioning system in place. We’d still want to spec things as we do currently, aiming for longevity.</p>
<p>There will not be different versions of <code>fetch</code> across versions, unless they are very major differences (like CE v0 vs CE v1). The main differences across versions would be absolutely necessary small changes, while entire distinct old APIs are removed or distinct new APIs are added, but we would avoid incrementally changing an API all the time just to make it more ideal if it already works.</p>
<p>In other words, the changes would be like from <code>XMLHttpRequest</code> to <code>fetch</code>, but not something where <code>fetch</code> morphs over time. The browser API versioning system would still use stable specs for their APIs, not continually morphing specs.</p>
<p>Specs would continue as they do today: aiming for stable changes that should last a long time. This gives us mostly the opportunity to drop APIs that we’ve proved over decades that we can drop.</p>
<p>In the end, selecting the sets of APIs that go into versions becomes mostly a matter of choosing which APIs go or don’t go into versions, and in the worst case having to ensure that small changes in APIs are branched across versions in <em>very rare occasions</em>. Critical bug fixes would be “back ported” simply by patching those fixes in the shared code that all versions use.</p>
<hr/>
<p>I’m trying to imagine something that makes things better for both web devs and browser devs. I guess it is sort of like feature layers. A “version” is <em>mainly</em> a set of features where the features are spec’d according to long-term standards like currently, a spec author would not be changing an API spec every month in breaking ways. Maybe even the time between Web API versions could be a few years, once people have had enough time to realize problems and new solutions.</p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>
