<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>CSS nesting specification</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>
  
  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="66" alt="WICG" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">A partial archive of discourse.wicg.io as of Saturday February 24, 2024.</div>
    <h1 class="topic-title">CSS nesting specification</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/582_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">jonathank</div>
          <div class="creation_date">2015-04-29</div>
          <div class="post_content">
<p>Is there an interest into dragging this into the limelight again? (I feel I raised this on here before but can’t find where)</p>
<p>The spec written by <span class="mention">@tabatkins</span> <a href="http://tabatkins.github.io/specs/css-nesting/" rel="nofollow noopener">http://tabatkins.github.io/specs/css-nesting/</a></p>
<p>I thought it would be worth bringing up again as there is interest in implementing this into CSSNext:
<aside class="onebox githubissue">
<header class="source">
<a href="https://github.com/MoOx/postcss-cssnext/issues/80" rel="nofollow noopener" target="_blank">github.com/MoOx/postcss-cssnext</a>
</header>
<article class="onebox-body">
<div class="github-row">
<div class="github-icon-container" title="Issue">
<svg aria-hidden="true" class="github-icon" height="60" viewbox="0 0 14 16" width="60"><path d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
</div>
<div class="github-info-container">
<h4>
<a href="https://github.com/MoOx/postcss-cssnext/issues/80" rel="nofollow noopener" target="_blank">Support CSS nesting</a>
</h4>
<div class="github-info">
<div class="date">
        opened <span class="discourse-local-date" data-date="2015-03-19" data-format="ll" data-time="12:54:30" data-timezone="UTC">12:54PM - 19 Mar 15 UTC</span>
</div>
<div class="date">
          closed <span class="discourse-local-date" data-date="2016-01-08" data-format="ll" data-time="07:38:55" data-timezone="UTC">07:38AM - 08 Jan 16 UTC</span>
</div>
<div class="user">
<a href="https://github.com/MoOx" rel="nofollow noopener" target="_blank">
<img alt="MoOx" class="onebox-avatar-inline" height="20" src="https://avatars2.githubusercontent.com/u/157534?v=4" width="20"/>
          MoOx
        </a>
</div>
</div>
</div>
</div>
<div class="github-row">
<p class="github-content">I am opening this issue just for people who want to follow the evolution of @tabatkins unofficial draft
http://tabatkins.github.io/specs/css-nesting/
If this become a...</p>
</div>
<div class="labels">
<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">type: enhancement</span>
<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">type: feature request</span>
</div>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
</p>
<p>I think the biggest change would be around formatting, example 5 uses:</p>
<pre><code class="lang-auto">  div {{
    .keyword {color: red;}
    &amp;:hover {background-color: rgb(200, 255, 255);}
    section &gt; &amp; {border: 2px solid gray;}
  }}
</code></pre>
<p>Which nowhere else is made clear that multiple nested selections can be used within the block, so I would advocate changing examples to this style formatting:</p>
<pre><code class="lang-auto">table.colortable {
  {
    td {
      text-align:center;

      {
        &amp;.c { text-transform:uppercase }
        &amp;:first-child, &amp;:first-child + td { border:1px solid black }
      }
    }
    th {
      text-align:center;
      background:black;
      color:white;
    }
  }
}
</code></pre>
<p>I understand the reasoning behind the nesting selectors however would a different character be possible?
What that might be I’m not sure as the following are all likely out: <code>[]&lt;&gt;()*@+"':</code> backticks perhaps or slashes?</p>
<pre><code class="lang-auto">a {
 \
   span {
     color: red;
   }
 \
}
</code></pre>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/302_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">tabatkins</div>
          <div class="creation_date">2015-05-15</div>
          <div class="post_content">
<p>Well, backslash is out, as that’s used for character escapes. <img alt=":slight_smile:" class="emoji" src="//discourse.wicg.io/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/582_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">jonathank</div>
          <div class="creation_date">2015-05-15</div>
          <div class="post_content">
<p>It was the first char that looked remotely decent that looked alright in the list, it was just to kick the discussion off <img alt=":smiley:" class="emoji" src="//discourse.wicg.io/images/emoji/twitter/smiley.png?v=5" title=":smiley:"/> .</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/612_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Michiel</div>
          <div class="creation_date">2015-06-16</div>
          <div class="post_content">
<p>Square brackets look good to me; since it’s essentially an array of objects (looking at the JavaScript syntax). On the other, curly brackets look more natural in CSS.</p>
<pre><code class="lang-auto">table {
  [
    td {
      color: pineapple;
    }

    th {
     color: seaweed; 
    }
  ]
}
</code></pre>
<p>Or with curly brackets:</p>
<pre><code class="lang-auto">table {
  {
    td {
      color: pineapple;
    }

    th {
     color: seaweed; 
    }
  }
}
</code></pre>
<p>I think the square brackets stand out more and thus make it more readable; it triggers the brain with a “Hey this is new” sort of vibe. Not sure if this would play nice with the attribute selector, maybe <span class="mention">@tabatkins</span> can enlighten us?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1815_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">jonathantneal</div>
          <div class="creation_date">2015-06-16</div>
          <div class="post_content">
<p>I did not realize this had not been written.</p>
<p>If it’s not already done, I’ll see if I can write one.</p>
<pre><code class="lang-css">/* with nesting */

a, b {
	color: red;

	{
		x &amp;:hover y {
			color: blue;
		}
	}
}
</code></pre>
<pre><code class="lang-css">/* after flattening */

a, b {
	color: red;
}

x a:hover y, x b:hover y {
	color: blue;
}
</code></pre>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/302_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">tabatkins</div>
          <div class="creation_date">2015-06-16</div>
          <div class="post_content">
<aside class="quote" data-post="4" data-topic="839">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="//discourse.wicg.io/user_avatar/discourse.wicg.io/michiel/40/612_1.png" width="20"/> Michiel:</div>
<blockquote>
<p>I think the square brackets stand out more and thus make it more readable; it triggers the brain with a “Hey this is new” sort of vibe. Not sure if this would play nice with the attribute selector,</p>
</blockquote>
</aside>
<p>No problem; this isn’t in a context that already expects selectors, so there’s no clash syntactically.  (That said, I still prefer curlies, for consistency.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/612_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Michiel</div>
          <div class="creation_date">2015-06-16</div>
          <div class="post_content">
<p>I’m with you on the consistency thing. Here is a somewhat more complex example which I converted from SCSS to CSS with both curlies and squares.</p>
<pre><code class="lang-auto">article {
  position: relative;
  padding: 0 15px 30px;
  
  [
    header {
      margin: 0 -15px;
      padding: 10px;
      font-size: 18px;
      font-weight: 400;
      line-height: 20px;
      text-align: center;
      background-color: #bfda23;
    }
    
    &lt;!-- Product title --&gt;
    h2 {
      font-size: 26px;
      line-height: 30px;
      text-align: center;
    }
    
    &lt;!-- Product description --&gt;
    h2 + p {
      font-size: 13px;
      line-height: 22px;
    }
  
    &lt;!-- Product image --&gt;
    figure {
      position: relative;
      margin: 30px 0;
      
      [
        img[src*="product-images/"] {
          max-width: 100%;
          
          &lt;!-- Default label attributes--&gt;
          [
            &amp; + img {
              position: absolute;
              width: 169px;
            }
          ]
        }
      ]
    }
  ]
}
</code></pre>
<pre><code class="lang-auto">article {
  position: relative;
  padding: 0 15px 30px;
  
  {
    header {
      margin: 0 -15px;
      padding: 10px;
      font-size: 18px;
      font-weight: 400;
      line-height: 20px;
      text-align: center;
      background-color: #bfda23;
    }
    
    &lt;!-- Product title --&gt;
    h2 {
      font-size: 26px;
      line-height: 30px;
      text-align: center;
    }
    
    &lt;!-- Product description --&gt;
    h2 + p {
      font-size: 13px;
      line-height: 22px;
    }
  
    &lt;!-- Product image --&gt;
    figure {
      position: relative;
      margin: 30px 0;
      
      {
        img[src*="product-images/"] {
          max-width: 100%;
          
          &lt;!-- Default label attributes--&gt;
          {
            &amp; + img {
              position: absolute;
              width: 169px;
            }
          }
        }
      }
    }
  }
}
</code></pre>
<p>I still think the square brackets look better; you can clearly see where nested blocks end.</p>
<p>As Huey Lewis &amp; The News say: “It’s hip to be square” <img alt=":wink:" class="emoji" src="//discourse.wicg.io/images/emoji/twitter/wink.png?v=5" title=":wink:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/636_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Edwin_Reynoso</div>
          <div class="creation_date">2015-06-16</div>
          <div class="post_content">
<p>I smell lots of spaghetti CSS if this is over abused.</p>
<p>I for one if something starts to get really deep won’t mind writing a new selector and it’s body.</p>
<pre><code>html {
   body {
       main {
           section {
              div {

              }
           }
       }
   }
}
</code></pre>
<p>Over:</p>
<pre><code>html body main section div {

}
</code></pre>
<p>Obviously this is not the best example hopefully nobody actually does that in real life.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/302_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">tabatkins</div>
          <div class="creation_date">2015-06-16</div>
          <div class="post_content">
<aside class="quote" data-post="8" data-topic="839">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="//discourse.wicg.io/user_avatar/discourse.wicg.io/edwin_reynoso/40/636_1.png" width="20"/> Edwin_Reynoso:</div>
<blockquote>
<p>I smell lots of spaghetti CSS if this is over abused.</p>
</blockquote>
</aside>
<p>Yes, the same debate is had in every preprocessor that supports nesting.  In general, the advice seems to be to follow the Inception rule - four layers is too deep.</p>
<aside class="quote" data-post="7" data-topic="839">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="//discourse.wicg.io/user_avatar/discourse.wicg.io/michiel/40/612_1.png" width="20"/> Michiel:</div>
<blockquote>
<p>I still think the square brackets look better; you can clearly see where nested blocks end.</p>
</blockquote>
</aside>
<p>Eh, that’s what bracket-matching in your IDE is for. <img alt=":slight_smile:" class="emoji" src="//discourse.wicg.io/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/582_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">jonathank</div>
          <div class="creation_date">2015-06-17</div>
          <div class="post_content">
<p>I think the different sigil makes a lot of sense as it doesn’t really mean the same thing does it.
I thought you were not happy with using the same characters again to keep CSS parsers simple.</p>
<p>These all should be possible right (Not that I think I like any of the options or square more for that matter)?</p>
<pre><code class="lang-auto">table {
  (
    td {
      color: pineapple;
    }

    th {
     color: seaweed; 
    }
  )
}
</code></pre>
<pre><code class="lang-auto">table {
  &lt;
    td {
      color: pineapple;
    }

    th {
     color: seaweed; 
    }
  &gt;
}
</code></pre>
<pre><code class="lang-auto">table {
  `
    td {
      color: pineapple;
    }

    th {
     color: seaweed; 
    }
  `
}
</code></pre>
<pre><code class="lang-auto">table {
  |
    td {
      color: pineapple;
    }

    th {
     color: seaweed; 
    }
  |
}
</code></pre>
<aside class="quote" data-post="9" data-topic="839">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="//discourse.wicg.io/user_avatar/discourse.wicg.io/tabatkins/40/302_1.png" width="20"/> tabatkins:</div>
<blockquote>
<p>Eh, that’s what bracket-matching in your IDE is for. <img alt=":slight_smile:" class="emoji" src="//discourse.wicg.io/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:"/></p>
</blockquote>
</aside>
<p>I still stand by a syntax should look easy to read printed out.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/636_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Edwin_Reynoso</div>
          <div class="creation_date">2015-06-17</div>
          <div class="post_content">
<p>I’m feeling this one most:</p>
<pre><code class="lang-auto">table {
  &lt;
    td {
      color: pineapple;
    }

    th {
      color: seaweed;
    }
  &gt;
}

</code></pre>
<p>And IDK why. But I really don’t mind the curly braces.</p>
<p>Here’s another idea:</p>
<p>Perhaps we could have something that declares a part of the stylesheet to allow this but it’ll will have to be done by whitespace (Which most people will probably not like, because of minification):</p>
<pre><code class="lang-auto">@deepSelecting {
  table
    td
      color: pineapple;
    th
      color: seaweed;
}
</code></pre>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/612_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Michiel</div>
          <div class="creation_date">2015-06-17</div>
          <div class="post_content">
<p>Sure, but I feel CSS should be readable in plain text format (it always has been). Why rely on an IDE if a different character achieves the same thing?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1815_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">jonathantneal</div>
          <div class="creation_date">2015-06-17</div>
          <div class="post_content">
<p>Here goes for the polyfill: <a href="https://github.com/jonathantneal/postcss-nesting" rel="nofollow noopener">https://github.com/jonathantneal/postcss-nesting</a></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/582_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">jonathank</div>
          <div class="creation_date">2015-06-17</div>
          <div class="post_content">
<p>After experimenting today lots, I think I am still seeing the <code>{</code> syntax as the easiest to read.
I use zero formatting and highlighting in vim and as <span class="mention">@leaverou</span> said I’m a ‘extreme outlier on this’; but if I can cope most people can.</p>
<p>I would potentially suggest making it an <span class="mention">@rule</span> too (However this adds another type of <span class="mention">@rule</span>).</p>
<p>So:</p>
<pre><code class="lang-css">.thing {
  @matches {
    &amp;:hover {
      color: blue;
    }
    .thing {
      color: red;
    }
  }
}
</code></pre>
<p>Would be:</p>
<pre><code class="lang-css">.thing:hover {
  color: blue;
}
.thing .thing {
  color: red;
}
</code></pre>
<p><span class="mention">@jonathantneal</span> Fancy pollyfilling <span class="mention">@tabatkins</span>’s <span class="mention">@extend</span> syntax too <img alt=":stuck_out_tongue:" class="emoji" src="//discourse.wicg.io/images/emoji/twitter/stuck_out_tongue.png?v=5" title=":stuck_out_tongue:"/> I looked at how feasible it was today and certainly seems easy enough.</p>
<p>I wanted it so I could easily use nested custom properties within a fake shadow DOM so the risks of it not cascading went away.</p>
<p>If not I was going to have a go tonight anyway <img alt=":smiley:" class="emoji" src="//discourse.wicg.io/images/emoji/twitter/smiley.png?v=5" title=":smiley:"/></p>
<p><em>PS: The smilies here are still creepy.</em></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1853_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">MoOx</div>
          <div class="creation_date">2015-06-17</div>
          <div class="post_content">
<p>I think current <span class="mention">@extend</span> proposal isn’t doable per tabatkins comment on this thread <a href="https://github.com/postcss/postcss/issues/321" rel="nofollow noopener">https://github.com/postcss/postcss/issues/321</a></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/582_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">jonathank</div>
          <div class="creation_date">2015-06-17</div>
          <div class="post_content">
<p><span class="mention">@MoOx</span> reading the spec it seems to be doable in certain circumstances but perhaps I don’t understand. For example <code>#id</code>'s would need to be turned into <code>[id=...]</code>.</p>
<p>However for the tiny use case I want it for it works: <a href="//discourse.wicg.io/t/custom-property-selectors/869/16">Custom property selectors</a></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/302_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">tabatkins</div>
          <div class="creation_date">2015-06-17</div>
          <div class="post_content">
<p>Taking this in a slightly different direction, here’s an alternate syntax proposal I’ve been mulling over and think I like.</p>
<p>The only reason we need <em>anything</em> special is because the grammar for declarations and selectors are ambiguous; specifically, a selector starting with a type selector and a pseudo-class looks just like a declaration, and you can’t tell which it is until you hit a curly or a semicolon.</p>
<p>If you can avoid that case, you’re golden.  And the common case for nesting is to start the selector with the nesting selector.  So:</p>
<ol>
<li>
<p>As long as you’re starting the selector with the nesting selector, you can nest it directly inside of the parent rule. No Nesting Block or anything else needed.  (Note: if you use a comma-separated list of selectors, <em>all</em> of them will have to start with the nesting selector, even though disambiguation has already technically been achieved by the <em>first</em> selector in the list.  If you don’t have this restriction, it’s a refactoring hazard; re-arranging selectors can break code.)</p>
</li>
<li>
<p>If you want to use the nesting selector anywhere else inside of a selector (like <code>.foo &amp;</code> to add extra styles only when it’s within a <code>.foo</code> ancestor), you have to add an <code>@nest</code> rule inside of the parent style rule, which then contains style rules with no restriction on &amp; placement.</p>
</li>
</ol>
<p>So in other words, these would be the two allowed syntaxes:</p>
<pre><code class="lang-css">.foo {
  color: red;
  &amp; .bar { color: blue; }
}

/* equivalent to
   .foo { color: red; }
   .foo .bar { color: blue; }
*/

.foo {
  color: red;
  @nest {
    .bar &amp; { color: blue; }
  }
}

/* equivalent to
   .foo { color: red; }
   .bar .foo { color: blue; }
*/
</code></pre>
<p>But something like this is illegal:</p>
<pre><code class="lang-css">.foo {
  color: red;
  .bar &amp; {
    color: blue;
  }
}
</code></pre>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/582_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">jonathank</div>
          <div class="creation_date">2015-06-17</div>
          <div class="post_content">
<p><code>@nest</code> is very intuitive as that was actually my goto for <code>@matches</code> above but I thought that would keep it in keeping.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/582_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">jonathank</div>
          <div class="creation_date">2015-06-17</div>
          <div class="post_content">
<p>The only slight problem with <code>@nest</code> is that it doesn’t convey descendants.</p>
<p>So:</p>
<pre><code class="lang-auto">.foo {
  color: red;
  @nest {
    .bar { color: blue; }
  }
}
</code></pre>
<p>Would equal:</p>
<pre><code class="lang-auto">.foo { color: red; }
.foo .bar { color: blue; }
</code></pre>
<p>or:</p>
<pre><code class="lang-auto">.foo { color: red; }
.foo.bar { color: blue; }
</code></pre>
<p>Which the convenience of multiple lines would be out there wouldn’t it.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/636_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Edwin_Reynoso</div>
          <div class="creation_date">2015-06-18</div>
          <div class="post_content">
<p>Only two I can think of:</p>
<p><code>@decendants</code>,  <code>@children</code></p>
<p><span class="mention">@jonathank</span> I’m assuming you want <code>@something { .bar {} }</code> more than <code>&amp; .bar</code>?</p>
<p>I’m not sure (I’m asking) is it easier to implement than <code>&amp; .bar</code> or being easier is irrelevant. If it’s irrelevant <code>&amp; .bar</code> is less code so?</p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>
