<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>Detect end of session to sync data with server</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>
  
  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="66" alt="WICG" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">A partial archive of discourse.wicg.io as of Saturday February 24, 2024.</div>
    <h1 class="topic-title">Detect end of session to sync data with server</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1601_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">collimarco</div>
          <div class="creation_date">2018-12-16</div>
          <div class="post_content">
<p>In order to sync local data with server, it would be useful to have an event that is triggered when the user leaves / closes a website. It is already possible to detect when a user leaves a page using the Page Visibility API, however it is not possible to detect the end of session (e.g. expiration of sessionStorage).</p>
<p>This event would allow developers to save data changes locally and collect website analytics (e.g. performance, tracking, user preferences) inside sessionStorage (or localStorage) and then send the data to the server only once, at the end of the visit, instead of creating an additional HTTP request for each page view.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1137_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Garbee</div>
          <div class="creation_date">2019-01-07</div>
          <div class="post_content">
<p>If you need it to persist between sessions, use Local Storage. If it doesn’t need to persist, then that’s when you use Session Storage. And if you want the server to track changes, that’s where you use cookies. Trying to have the server store a copy of the session storage doesn’t make much sense. Session storage is intended to be short-lived, so storing data in there needed between them isn’t using the proper technology for a task.</p>
<p>What exactly is the use-case you’re trying to achieve here? In general these techs exist for their intended goals and they work very well.</p>
<p>You also don’t need to send a request for each page view using local storage. You can send a request to update the server data only when a value is modified. That means regardless of when/how it happens, if the value changes the server will know. No need to handle it in a session ending event.</p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>
