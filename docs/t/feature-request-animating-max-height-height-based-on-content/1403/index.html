<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>Feature request: Animating max-height / height based on content</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>
  
  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="66" alt="WICG" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">A partial archive of discourse.wicg.io as of Saturday February 24, 2024.</div>
    <h1 class="topic-title">Feature request: Animating max-height / height based on content</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/917_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">craig.francis</div>
          <div class="creation_date">2016-03-22</div>
          <div class="post_content">
<p>I’m making the suggestion here as well, as requested by Alan Cutter:</p>
<p><a class="onebox" href="https://crbug.com/596330" rel="nofollow noopener" target="_blank">https://crbug.com/596330</a></p>
<p>When creating a disclosure widget:</p>
<pre><code>&lt;p&gt;&lt;a href="#widget"&gt;Show Terms &amp;amp; Conditions&lt;/a&gt;&lt;/p&gt;
&lt;div id="widget"&gt;
    &lt;p&gt;Long legal text, hidden by default.&lt;/p&gt;
&lt;/div&gt;
</code></pre>
<p>Developers used to use jQuery to display the hidden content with a height changing animation (so the content did not suddenly appear):</p>
<pre><code>$('#widget').slideToggle();
</code></pre>
<p>More recently we have been using CSS animations:</p>
<pre><code>#widget {
    overflow-y: hidden;
    max-height: 500px; /* approximate max height */
    transition-property: all;
    transition-duration: .5s;
}

#widget.closed {
    max-height: 0;
}
</code></pre>
<aside class="onebox whitelistedgeneric">
<header class="source">
<img class="site-icon" height="32" src="https://davidwalsh.name/wp-content/themes/punky/images/favicon-32.png" width="32"/>
<a href="https://davidwalsh.name/css-slide" rel="nofollow noopener" target="_blank" title="02:17PM - 26 August 2013">David Walsh Blog – 26 Aug 13</a>
</header>
<article class="onebox-body">
<div class="aspect-image" style="--aspect-ratio:250/194;"><img class="thumbnail" height="194" src="https://davidwalsh.name/wp-content/themes/punky/images/logo.png" width="250"/></div>
<h3><a href="https://davidwalsh.name/css-slide" rel="nofollow noopener" target="_blank">Pure CSS Slide Up and Slide Down</a></h3>
<p>After playing around with different CSS properties, I've found a way to make a pure CSS sliding effect.</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<p>Where <code>max-height</code> has to be guessed (not too high, as the animation will be too fast, and not too small, as content will be unreadable).</p>
<p>So can we take the <code>max-content</code> suggestion for the auto-resizing iframe, and allow it to work on the <code>max-height</code> (or <code>height</code>) properties:</p>
<pre><code>#widget {
    max-height: max-content;
}
</code></pre>
<hr/>
<p>This is related to the iframe and textarea resize requests:</p>
<aside class="onebox whitelistedgeneric">
<header class="source">
<img class="site-icon" height="32" src="https://github.githubassets.com/favicons/favicon.svg" width="32"/>
<a href="https://github.com/craigfrancis/iframe-height" rel="nofollow noopener" target="_blank">GitHub</a>
</header>
<article class="onebox-body">
<img class="thumbnail onebox-avatar" height="400" src="https://avatars2.githubusercontent.com/u/1296695?s=400&amp;v=4" width="400"/>
<h3><a href="https://github.com/craigfrancis/iframe-height" rel="nofollow noopener" target="_blank">craigfrancis/iframe-height</a></h3>
<p>Proposal for automatically setting an iframe height via HTML/CSS - craigfrancis/iframe-height</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<p>Where I also have a working demo:</p>
<p><a class="onebox" href="https://craigfrancis.github.io/iframe-height/additional/height-animation/" rel="nofollow noopener" target="_blank">https://craigfrancis.github.io/iframe-height/additional/height-animation/</a></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2752_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">ojanvafai</div>
          <div class="creation_date">2016-03-22</div>
          <div class="post_content">
<p>I support solving the problem of animating between lengths and keywords in general. It’s blocked on someone making a spec and getting buy-in from all the browser vendors, which involves solving all the problems with why it’s tricky to implement.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/917_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">craig.francis</div>
          <div class="creation_date">2016-03-22</div>
          <div class="post_content">
<p>I’m probably not the best person to write a spec, do you know who would be a good contact?</p>
<p>Just thinking there is a lot of web developers who create widgets that effectively use the jQuery <code>.slideToggle()</code>, and it’s not easy to implement that in CSS at the moment, so this would help quite a few people <img alt=":slight_smile:" class="emoji" src="//discourse.wicg.io/images/emoji/twitter/slight_smile.png?v=5" title=":slight_smile:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2752_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">ojanvafai</div>
          <div class="creation_date">2016-03-22</div>
          <div class="post_content">
<p>Someone who works on Web Animations might be a good starting point. <a href="https://w3c.github.io/web-animations/" rel="nofollow noopener">https://w3c.github.io/web-animations/</a></p>
<p>But, looking at the editors of that spec, I know the 3 googlers are very oversubscribed. So, unfortunately, I don’t think there’s anyone on the Chrome team with the time for this right now. But I’ll at least point the right Chrome people at this thread. <span class="mention">@tabatkins</span></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/917_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">craig.francis</div>
          <div class="creation_date">2016-03-23</div>
          <div class="post_content">
<p>Thanks, Alan Cutter has written up a nice explanation on: <a href="https://crbug.com/596330" rel="nofollow noopener">https://crbug.com/596330</a></p>
<p>In summary, animations currently work with known/fixed values, where a layout/paint is not required. So in this case, the animation would need to request a layout to get the height of the content.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/913_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">MT</div>
          <div class="creation_date">2016-03-24</div>
          <div class="post_content">
<p>The trick of animating <code>max-height</code> instead of <code>height</code> is actually a workaround for the issue related to lack of ability to animate from/to keywords like <code>auto</code> in CSS.</p>
<p>So if a better standard way to animate was going to be standardized, then it would probably make  much more sense to do this in relation to <code>height</code> itself, not <code>max-height</code>.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/917_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">craig.francis</div>
          <div class="creation_date">2016-03-24</div>
          <div class="post_content">
<p>Good point, I was supposed to change that to <code>height</code>, but while writing the message above, I was thinking about the way we do it now with <code>max-height</code>.</p>
<p>Unfortunately it does not look like this will be possible with the way animations work at the moment, so I’m also looking at a solution where JS can determine the height it needs to be (when currently overflow:hidden, and height:0)… far from perfect, but better than the hacks jQuery uses to make their implementation work.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/302_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">tabatkins</div>
          <div class="creation_date">2016-03-24</div>
          <div class="post_content">
<p>This isn’t <em>too</em> crazy.  The issue is that we need to allow keywords to show up in calc(), so that you can animate from <code>0px</code> to <code>auto</code> and get <code>calc(auto * .5)</code> in the middle.  That neatly wraps up the issue, which is finding a way to <em>represent</em> the intermediate values at computed-value time, when animations happens.</p>
<p>The CSSWG <em>does</em> plan to handle this, it’s just low-priority at the moment, especially since it will complicate the calc() data model for the object-based OM.</p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>
