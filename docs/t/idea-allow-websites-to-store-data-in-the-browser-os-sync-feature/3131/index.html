<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>[Idea] Allow websites to store data in the browser/OS sync feature</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>
  
  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="66" alt="WICG" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">A partial archive of discourse.wicg.io as of Thursday February 08, 2024.</div>
    <h1 class="topic-title">[Idea] Allow websites to store data in the browser/OS sync feature</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3804_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">simevidas</div>
          <div class="creation_date">2018-11-04</div>
          <div class="post_content">
<p><strong>Warning: This is just a random idea that I had.</strong></p>
<p>Browsers and operating systems can sync the user’s data and preferences across devices (e.g., I use Firefox Sync and iCloud syncing.)</p>
<p>What if websites could leverage this system to sync the preferences of their visitors without having to log them in?</p>
<p>Example scenario:</p>
<ol>
<li>A user visits a gaming site regularly.</li>
<li>Over time, the user’s preferences become known to the site, e.g., which types of games they like and what kind of content on the website they view the most.</li>
<li>The site displays a section that invites the user to sync these preferences via the browser’s sync feature.</li>
<li>The user chooses to do so, and the browser shows a prompt: “Would you like to store your preferences on this website in browser sync?”</li>
<li>Now, if the user has browser sync enabled on a different device and opens the same website on that device, the site will be able to access its stored preferences for that user and update its UI accordingly.</li>
</ol>
<p>The amount of data that an individual website could store this way would of course be limitied (I’m thinking small-ish JSON strings). The API would be similar to the Storage API: The site has to request storage/access rights, and the storage-request prompt can only be triggered on user interaction.</p>
<p>This system would solve the problem for users where they have to create accounts on each website. When I as a user visit the same website on multiple devices, I want to have one, continuous experience, but creating accounts on every single website and logging in constantly is a bad experience.</p>
<p>*thinking pause*</p>
<p>Wait a second. Websites could just sync the user’s anonymous session cookie via this system. That would be another option.</p>
<hr/>
<p>Ok, why is this a bad idea? <img alt=":grin:" class="emoji" src="//discourse.wicg.io/images/emoji/twitter/grin.png?v=6" title=":grin:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1710_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">yoavweiss</div>
          <div class="creation_date">2018-11-04</div>
          <div class="post_content">
<aside class="quote no-group" data-post="1" data-topic="3131">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="//discourse.wicg.io/user_avatar/discourse.wicg.io/simevidas/40/1026_1.png" width="20"/> simevidas:</div>
<blockquote>
<p>Ok, why is this a bad idea? <img alt=":grin:" class="emoji" src="//discourse.wicg.io/images/emoji/twitter/grin.png?v=6" title=":grin:"/></p>
</blockquote>
</aside>
<p>I’d guess the main argument against such a mechanism would be privacy and user expectations. One could argue that while users expect their e.g. usernames/passwords to be synced between devices, they wouldn’t want other information to be synced at the same time. With that said, might be worthwhile to run this by privacy conscious folks to see what they think.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">mkay581</div>
          <div class="creation_date">2018-11-04</div>
          <div class="post_content">
<p>So this would require the user to install a browser sync add-on or something on all devices? If so, not sure why I (as a user) would want to do this extra work to install a browser add-on just so that the website publisher can track my behavior. I would assume that, if the user hasn’t created an account or logged in, they probably don’t want to be tracked.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3804_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">simevidas</div>
          <div class="creation_date">2018-11-04</div>
          <div class="post_content">
<aside class="quote no-group" data-post="3" data-topic="3131">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="//discourse.wicg.io/user_avatar/discourse.wicg.io/mkay581/40/1723_1.png" width="20"/> mkay581:</div>
<blockquote>
<p>So this would require the user to install a browser sync add-on or something on all devices?</p>
</blockquote>
</aside>
<p>Firefox Sync is a built-in feature. I’m pretty sure other browsers include features with the same or similar functionality.</p>
<aside class="quote no-group" data-post="3" data-topic="3131">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="//discourse.wicg.io/user_avatar/discourse.wicg.io/mkay581/40/1723_1.png" width="20"/> mkay581:</div>
<blockquote>
<p>I would assume that, if the user hasn’t created an account or logged in, they probably don’t want to be tracked.</p>
</blockquote>
</aside>
<p>Creating an account and logging in is generally annoying, both for the user (creating a strong password, opening the confirmation email, being signed out unexpectedly) and for websites that don’t want to go though the trouble of implementing a login system.</p>
<p>For example, a very simple website might want to let the user set a few preferences, and then have those preferences work multi-device. Why would every website, no matter how small, have to perform login when it can just store and access the visitor’s preferences via a simple JavaScript API that uses the user’s browser sync as a storage location?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3066_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">jhpratt</div>
          <div class="creation_date">2018-11-04</div>
          <div class="post_content">
<p>I’m huge on privacy considerations, and I’m of the opinion that this would be okay, given that it’s encrypted. I imagine most vendors would do so, anyways.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">mkay581</div>
          <div class="creation_date">2018-11-04</div>
          <div class="post_content">
<aside class="quote no-group" data-post="4" data-topic="3131">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="//discourse.wicg.io/user_avatar/discourse.wicg.io/simevidas/40/1026_1.png" width="20"/> simevidas:</div>
<blockquote>
<p>Firefox Sync is a built-in feature. I’m pretty sure other browsers include features with the same or similar functionality.</p>
</blockquote>
</aside>
<p>Oh I see. So you’re proposing an alternative storage API that will allow us to store tiny pieces of data for any given session that can be persisted across devices? Sounds interesting, but how do you propose accurately associating the data with the same anonymous user across devices? IP address? Just because a user is on the same IP address and accesses the website from a difference device, doesnt necessarily mean its the same user.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2455_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">DanielHerr</div>
          <div class="creation_date">2018-11-04</div>
          <div class="post_content">
<p>It seems like the easiest way to do this would be using the credential management api to sync the anonymous user id.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3804_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">simevidas</div>
          <div class="creation_date">2018-11-04</div>
          <div class="post_content">
<aside class="quote no-group" data-post="6" data-topic="3131">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="//discourse.wicg.io/user_avatar/discourse.wicg.io/mkay581/40/1723_1.png" width="20"/> mkay581:</div>
<blockquote>
<p>So you’re proposing an alternative storage API that will allow us to store tiny pieces of data for any given session that can be persisted across devices?</p>
</blockquote>
</aside>
<p><strong>Actually, I think I was overthinking it</strong>. The Storage API already exists. All we need is for browsers to start syncing that data across devices.</p>
<p>I haven’t started using the Storage API yet, so I don’t know all its details, but I feel browsers could already start syncing that data if they wanted to (it could be an option in the browser’s settings: “Sync website persistent data”).</p>
<aside class="quote no-group" data-post="6" data-topic="3131">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="//discourse.wicg.io/user_avatar/discourse.wicg.io/mkay581/40/1723_1.png" width="20"/> mkay581:</div>
<blockquote>
<p>how do you propose accurately associating the data with the same anonymous user across devices? IP address? Just because a user is on the same IP address and accesses the website from a difference device, doesnt necessarily mean its the same user.</p>
</blockquote>
</aside>
<p>I don’t think there is a need for that. For example:</p>
<ol>
<li>I view content X on website</li>
<li>Website stores “user likes X” via Storage API</li>
<li>Browser syncs storage data across my devices</li>
<li>I open same website on different device</li>
<li>Website reads “user likes X” and updates start page to show more X</li>
</ol>
<p>Done. The website doesn’t care who <em>I</em> am, it just needs a place to store my browsing habits, preferences, etc. that works across devices. Storage API + browser sync would enable that.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">mkay581</div>
          <div class="creation_date">2018-11-05</div>
          <div class="post_content">
<p>I see. I guess I’m not quite sure of how this proposed storage API knows that the user in Step 2 is the same user in step 5. Someone above mentioned the Credential Management API, but not too familiar with it yet or whether that will be a viable solution.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3804_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">simevidas</div>
          <div class="creation_date">2018-11-05</div>
          <div class="post_content">
<aside class="quote no-group" data-post="9" data-topic="3131">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="//discourse.wicg.io/user_avatar/discourse.wicg.io/mkay581/40/1723_1.png" width="20"/> mkay581:</div>
<blockquote>
<p>I guess I’m not quite sure of how this proposed storage API knows that the user in Step 2 is the same user in step 5.</p>
</blockquote>
</aside>
<p>If the website reads “user likes X” via the Storage API, then that means that that website has set this value in the past in the same browser. So, unless multiple people use the same browser, it’s the same user.</p>
<p>If the browser were to start syncing this data across the user’s devices, as I have suggested, that would still mean that it’s the same user, since you have to sign in into the browser to activate browser sync.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">mkay581</div>
          <div class="creation_date">2018-11-05</div>
          <div class="post_content">
<p>Yes, there is a good chance its the same user, but there are a lot of cases where multiple users use the same device and browser in a household of multiple family members and they each may or may not sign into the browser.  So there’s room for inaccuracies. There is no reliable way to determine that, in every case, we’re dealing with the same user.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2455_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">DanielHerr</div>
          <div class="creation_date">2018-11-05</div>
          <div class="post_content">
<p>If multiple users are for some reason sharing an account, why would we need to identify which person is using it? They would be sharing data on every site saved on the device, so why would it be any different with synced data?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">mkay581</div>
          <div class="creation_date">2018-11-07</div>
          <div class="post_content">
<aside class="quote no-group" data-post="12" data-topic="3131">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="//discourse.wicg.io/letter_avatar_proxy/v2/letter/d/6f9a4e/40.png" width="20"/> DanielHerr:</div>
<blockquote>
<p>If multiple users are for some reason sharing an account, why would we need to identify which person is using it?</p>
</blockquote>
</aside>
<p>The original proposal was to collect and sync data on a user’s behavior on a website so, that on other devices, that website will be tailored based on that data. I’m assuming this was proposed to be helpful and give the user a better web experience on all devices. How can this data be all that helpful to a user if this data is intermingled with the behavior of other users of a shared device in the same household?</p>
<p>I’ll use the example above (with a few edits) to illustrate my point:</p>
<ol>
<li>User 1 views content X on website via a shared computer in a multiple user household</li>
<li>Website stores “user 1 likes X”</li>
<li>Browser syncs storage data across shared computer, user 1’s mobile phone, and user 2’s mobile phone</li>
<li>User 2 views content Y on website via the same computed in Step 1 (above)</li>
<li>Website stores “user 2 likes Y”</li>
<li>Browser syncs storage data across shared computer, user 1’s mobile phone, and user 2’s mobile phone</li>
<li>User 2 opens same website on mobile phone browser</li>
<li>Website reads “user 2 likes X and Y” and updates start page to show more X and Y</li>
</ol>
<p>The problem here is that user 2 actually never looked at X, but the website shows content based on user 1’s behavior, which is inaccurate. The same will be the case for user 1 and Y content. I fail to see how this feature would be useful to these users, if this is likely to be the case.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3804_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">simevidas</div>
          <div class="creation_date">2018-11-07</div>
          <div class="post_content">
<aside class="quote no-group" data-post="13" data-topic="3131">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="//discourse.wicg.io/user_avatar/discourse.wicg.io/mkay581/40/1723_1.png" width="20"/> mkay581:</div>
<blockquote>
<p>Browser syncs storage data across shared computer, user 1’s mobile phone, and user 2’s mobile phone</p>
</blockquote>
</aside>
<p>I don’t think this scenario is possible. Browser sync requires the user to (1) create a password-protected account and (2) manually set up sync for each additional device. Two different people have no reason to use the same Google or Firefox account in their mobile browsers (unless one of the users is spying on the other, or something like that).</p>
<p>Note that browser sync captures everything, incl. the user’s browsing history and all their saved logins. If a household uses the same desktop browser, they have no reason to set up browser sync in that browser, esp. in Chrome’s case since that would mean that one of the people would have to sign in using their Google account and then stay signed in while others are using the browser.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">mkay581</div>
          <div class="creation_date">2018-11-07</div>
          <div class="post_content">
<p>Certain browsers will automatically log the user into the browser when logging into their gmail for instance. I can see someone accepting browser sync after having unknowingly been logged into the browser, which would make my scenario possible, no?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3804_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">simevidas</div>
          <div class="creation_date">2018-11-07</div>
          <div class="post_content">
<aside class="quote no-group" data-full="true" data-post="15" data-topic="3131">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="//discourse.wicg.io/user_avatar/discourse.wicg.io/mkay581/40/1723_1.png" width="20"/> mkay581:</div>
<blockquote>
<p>Certain browsers will automatically log the user into the browser when logging into their gmail for instance. I can see someone accepting browser sync after having unknowingly been logged into the browser, which would make my scenario possible, no?</p>
</blockquote>
</aside>
<p>Yes, Chrome. But it also logs the user out of the browser when they log out of Gmail. And sync still has to be enabled separately via Chrome’s UI.</p>
<p>If someone logs into Gmail, enables sync, and still lets other people use the same browser without logging out first, then the browsing activity of these other people will be synced under that user’s Google account. This is not a problem with snyc.</p>
<p>Note that your scenario, as you described it, still isn’t possible since two people use different Google accounts on their devices, so only the primary user’s mobile browser would be synced with the desktop browser. Again, sync works as advertised, and it’s the user’s problem for letting other people use a browser that is logged into their Google account.</p>
<p>To summarize, adding website data to sync would not fundamentally change how sync works, as sync already stores the user’s browsing history and stored passwords. In other words, if one user’s sync includes data from other users, then the user has to fix that on their end.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1597_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">tomayac</div>
          <div class="creation_date">2018-11-07</div>
          <div class="post_content">
<p>Hmm, sounds like this could be a nice addition to <a href="https://storage.spec.whatwg.org/#persistence">Persistent Storage</a>.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/2018_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">reillyg</div>
          <div class="creation_date">2018-11-07</div>
          <div class="post_content">
<p>As an aside, Chrome Apps/Extensions have a <a href="https://developer.chrome.com/extensions/storage" rel="nofollow noopener">storage API</a> that includes synced storage. It looks like this is also included in Web Extensions.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3804_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">simevidas</div>
          <div class="creation_date">2018-11-08</div>
          <div class="post_content">
<aside class="quote no-group" data-post="17" data-topic="3131">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="//discourse.wicg.io/user_avatar/discourse.wicg.io/tomayac/40/1597_1.png" width="20"/> tomayac:</div>
<blockquote>
<p>this could be a nice addition to <a href="https://storage.spec.whatwg.org/#persistence">Persistent Storage</a>.</p>
</blockquote>
</aside>
<p>Ok, I’ve read up on the Storage API (probably should have done this sooner <img alt=":sweat_smile:" class="emoji" src="//discourse.wicg.io/images/emoji/twitter/sweat_smile.png?v=6" title=":sweat_smile:"/>) and <a href="https://webplatform.news/issues/2018-11-07" rel="nofollow noopener">posted a summary</a> on my website.</p>
<p>So it turns out, that can be a lot of data, potentially even 100+ MB for a single website that has been granted persistent storage. Probably too much for browser sync.</p>
<p>However, if there was a way for websites to declare some of their data as “synced storage,” that could work. So websites would be able to promote a size-limited <em>subset</em> of their total storage as <em>syncable</em>, and then the browser would know that that part of the site storage is safe to sync.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/630_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">nolanlawson</div>
          <div class="creation_date">2020-05-24</div>
          <div class="post_content">
<p>This is an old topic, but I’d like to +1 it.</p>
<p>I noticed that when you transfer data from one iOS device to another (e.g. you buy a new phone), all of your apps come with it, including webapps you’ve pinned to the home screen. But sadly if you’ve set any user preferences, then you have to set those all over again.</p>
<blockquote>
<p>So websites would be able to promote a size-limited <em>subset</em> of their total storage as <em>syncable</em> , and then the browser would know that that part of the site storage is safe to sync.</p>
</blockquote>
<p>This would be ideal for the PWA I’ve built, <a href="https://pinafore.social/">Pinafore</a>. Most of the data it stores in IndexedDB/Cache is not critical to be synced across devices (e.g. cached HTML/CSS/JS resources, cached social media posts), but there are some user preferences (theme color, notification preferences, etc.) which are basically a very tiny JSON file that would be nice to sync across the user’s devices.</p>
<p>Allowing the web developer to clearly specify <em>which</em> data should be synced would also solve the problem of “partial” data. The web developer would have full awareness that a newly-synced session might have the “synced” data but not the “unsynced” data. (Origin storage like LocalStorage and IDB are guaranteed to be all-or-nothing, completely cleared or not cleared at all.)</p>
<blockquote>
<p>I’d guess the main argument against such a mechanism would be privacy and user expectations</p>
</blockquote>
<p>This is tricky. The value of this API to me, as a web developer, is that I could store user preferences across devices without having to know anything about their identity, and behind the scenes Apple/Google/Microsoft/etc would sync their data for me. Unfortunately this very fact would allow me, the developer, to gain some knowledge about the user’s Apple/Google/Microsoft account.</p>
<p>I imagine an API like this would probably have to, at a minimum, be gated based on <a href="https://www.chromium.org/developers/design-documents/site-engagement">site engagement</a> – e.g. it only activates if the user actually installs the PWA to their home screen. Perhaps UAs could also decide to be more explicit about this – the first time you boot up a PWA on your new phone, the browser might ask “Transfer site data for <a href="http://example.com">example.com</a> from your old phone?” or something like that.</p>
<p>There’s also the question of update cadence and how one device may be notified of changes on another device. But because it’s probably too much to ask of developers to choose a conflict resolution strategy, maybe this API would be best as a simple key-value store with no expectation that the keys will sync together. (E.g. I update keys A and B on device 1, I update keys B and C on device 2, and now on device 3 I may get any combination of A, B, and C from those devices – developers shouldn’t make any assumptions about data integrity or transactionality.)</p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>
