<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>[Proposal] Support query for nearest sibling matching a selector</title>
    <link rel="stylesheet" href="../../../archived.css" />
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
  </head>
  
  <body>
    <header class="header">
      <div class="title-span">
        <a href="../../../">
          <img src="../../../images/site-logo.png" height="66" alt="WICG" id="site-logo" />
        </a>
      </div>
    </header>

    <div class="main">
    <div class="archive-span">A partial archive of discourse.wicg.io as of Saturday February 24, 2024.</div>
    <h1 class="topic-title">[Proposal] Support query for nearest sibling matching a selector</h1>
            <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1674_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">bahrus</div>
          <div class="creation_date">2019-04-28</div>
          <div class="post_content">
<p>Element.querySelector[all] performs searches starting from the first child of an element.</p>
<p>Element.closest returns the nearest ancestor.</p>
<p>But this is missing one critical direction – nearest sibling.  JQuery supports this with .next().</p>
<p>Maybe another parameter could be added to Element.closest, indicating which direction to search in?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/3804_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">simevidas</div>
          <div class="creation_date">2019-04-27</div>
          <div class="post_content">
<p>Could you describe a scenario where jQuery’s <code>next</code> method is useful?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1674_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">bahrus</div>
          <div class="creation_date">2019-04-28</div>
          <div class="post_content">
<p>Well, I find the need for it (<a href="https://gomakethings.com/finding-the-next-and-previous-sibling-elements-that-match-a-selector-with-vanilla-js/" rel="nofollow noopener">or the non-JQuery equivalent</a>) personally</p>
<p>But a <a href="https://www.google.com/search?biw=1707&amp;bih=850&amp;ei=fGnFXNu8BOOhggfn4b7oDw&amp;q=jquery+.next%28%29+site%3Astackoverflow.com&amp;oq=jquery+.next%28%29+site%3Astackoverflow.com&amp;gs_l=psy-ab.3...9429.34287..34599...14.0..0.89.2079.34......0....1..gws-wiz.......0i71j35i39j0i67j0i131j0j0i10j0i13j0i20i263j0i22i30j0i22i10i30j33i22i29i30j33i160j33i10.HmpIYCcNQpk" rel="nofollow noopener">google search of stack overflow</a> reveals it is certainly not a totally neglected feature of JQuery.</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/{size}.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">mkay581</div>
          <div class="creation_date">2019-04-28</div>
          <div class="post_content">
<p>The title seems to suggest just querying sibling elements. That can be done pretty easily using <code>previousElementSibling</code> and <code>nextElementSibling</code> properties like your article mentions.</p>
<p>Buuuut I think you want to query next and previous non-sibling elements in the DOM too? Definitely doesnt seem to be anything for that in the spec. But I agree with  <span class="mention">@simevidas</span>. What is a use case these days where you would need that? Gauging usefulness can be hairy in Google search because adoption may be popular but still a really old way of doing things or may be popular for a special use case. Looking forward to hearing from you!</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1674_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">bahrus</div>
          <div class="creation_date">2019-04-28</div>
          <div class="post_content">
<p>Hi <span class="mention">@mkay581</span>, I’ve added “matching a selector” to the title to be more clear how this differs from [previous/next]ElementSibling.</p>
<p>I can only give general use cases – sometimes you want to find siblings that match a selector, not just children or parents.</p>
<p>In articles arguing why you don’t need <a href="https://github.com/nefe/You-Dont-Need-jQuery#1.5" rel="nofollow noopener">JQuery anymore</a>, this functionality looks quite a bit uglier in the native format, making sticking to JQuery all the more tempting.</p>
<p>According to this web site, <a href="https://w3techs.com/technologies/overview/javascript_library/all" rel="nofollow noopener">the usage of JQuery has yet to drop</a>.  Why give web sites an excuse?  <img alt=":slight_smile:" class="emoji" src="//discourse.wicg.io/images/emoji/twitter/slight_smile.png?v=9" title=":slight_smile:"/></p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1137_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Garbee</div>
          <div class="creation_date">2019-04-28</div>
          <div class="post_content">
<aside class="quote no-group" data-post="5" data-topic="3521">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="//discourse.wicg.io/user_avatar/discourse.wicg.io/bahrus/40/1674_2.png" width="20"/> bahrus:</div>
<blockquote>
<p>this functionality looks quite a bit uglier in the native format, making sticking to JQuery all the more tempting.</p>
</blockquote>
</aside>
<p>Yup, and native specs will continue to “look uglier” than libraries and wrappers. The native web needs to be precise and have the least chance of colliding with other things.</p>
<p>The native web could get a next-style method where you can provide a query to filter with, sure. But it would not be named <code>next</code> almost certainly. It’s too ambiguous as to what exactly you’re trying to get.</p>
<p>I think the bigger driving point here is, <strong>Why do we need this in the native web</strong>? Doing it by hand isn’t terribly difficult, lots of libraries exists that provide it. Or you could make a simple function in the project to do the task. It isn’t saving all too many lines of code really, so what is the benefit that having it baked in provides?</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1674_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">bahrus</div>
          <div class="creation_date">2019-04-29</div>
          <div class="post_content">
<p>Well, I guess you would be in favor of throwing away maybe half of all the api then that’s already built into the browser? <img alt=":slight_smile:" class="emoji" src="//discourse.wicg.io/images/emoji/twitter/slight_smile.png?v=9" title=":slight_smile:"/>  Or at least think it was a mistake?  Should the browser never have attempted to incorporate JQuery’s popular features into the browser?</p>
<p>I agree with you that use of the name next(), as JQuery uses, would be confusing.</p>
<p>It’s kind of interesting that the browser incorporated JQuery’s “closest” method (at least a subset of it), even sticking to the name.  It’s not clear to me that implementing “closest” saved that many lines of code either, when looked at from the point of view of a single application.  Was that a mistake? It seems like there’s some mathematical formula that would ideal to be able determine what is worth adding to the browser:  (lines of code needed to implemented) * (number of web sites that use this functionality).  The big problem is there doesn’t seem to be a scientific way of determining the second factor.</p>
<p>I think it’s kind of confusing to have “closest” that only matches going up, and querySelector that only matches going down, and nothing that matches going sideways.  Has anyone scientifically determined that searching sideways is significantly less needed than the other two directions?  My guess ( in terms of volume of use) would be down =&gt; sideways =&gt; up, so having jquery’s “closest” but not “next” is a travesty of justice <img alt=":slight_smile:" class="emoji" src="//discourse.wicg.io/images/emoji/twitter/slight_smile.png?v=9" title=":slight_smile:"/></p>
<p>My vote would be to simplify the learning curve, and enhance “closest” with a second parameter, to be able to specify what direction to search in, which would effectively cause querySelector to be redundant (I think).  Directions could be ancestor, descendant, previousSibling, nextSibling (and maybe some combinations?).  For backwards compatibility, ancestor would have to be the default.  “Closest” is a lot easier to understand than “QuerySelector.”  Plus it’s shorter (especially if that second parameter could be made small, like ‘^’, ‘&gt;’, ‘&lt;’, ‘v’).</p>
<p>I also wonder whether when browsers implement these features natively, they might have any fancy techniques for caching results?</p>
<p>There are other precedents for duplicate functionality being provided in the browser api as the browser evolves…</p>
<p>Just my two cents</p>
          </div>
        </div>
      </div>

      <div class="post_container">
        <div class="avatar_container">
          <img src="../../../images/1137_2.png" class="avatar" />
        </div>
        <div class="post">
          <div class="user_name">Garbee</div>
          <div class="creation_date">2019-05-01</div>
          <div class="post_content">
<p>There is a fine line between adding a few of the higher-end helpers and adding everything in. It’s a very slippery slope. I’m fairly certain all of jQuery was reviewed at some point and decisions made on what to move in and what not to. At this point, it would need to be a <em>very</em> compelling reason to pull something else in from it.</p>
<p>We can’t just stuff everything in because it exists and <em>someone</em> finds it useful. Everyone will find everything useful. Justification behind use-cases matters, especially to show there is a benefit to including it in the engines vs letting it exist in user-land.</p>
<p>Also engines have different naming conventions to be more explicit and allow for future expansion cleanly. <code>querySelector</code> is named for this kind of purpose. We shouldn’t go stuffing more names in to the same methods just to appeal to some “learning curve.” Developers deal with multiple varying APIs all day in their work, this is no different. We have powerful tooling and documentation resources to aid us in discovering and using these various APIs. It’s OK. We don’t need every little thing to relate to every other thing in any other given system or language.</p>
          </div>
        </div>
      </div>


    </div>
  </body>
</html>
